<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Installation and Usage of (D)COM Server with Scilab</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="RDCOM.css">
</head><body>


<h2>Installation and Usage of (D)COM Server with Scilab</h2>


<h3></h3>

<p>
This file describes the installation procedure of (D)COM Server for the Scilab
software package.
</p>
<p>
R/Scilab (D)COM Server &gt;= 3.0 requires Scilab version 5.0 or later. To run
previous versions of Scilab (4.x is supported, too), contact the author.
</p>
<p>
R/Scilab (D)COM Server supports access to the Scilab software version 5.0 (or
later) from COM client applications. Scilab (D)COM Server <EM>is</EM> <font face="Courier New,Courier" color="#666666"><b>R</b></font> (D)COM
Server. The different name Scilab (D)COM Server is used throughout this
document for readers' comfort only.
</p>


<h3>Archives</h3>

<dl>
<dt><code>R_Scilab_DCOM3.0-1B5.exe</code></dt><dd>setup program for server and sample
code (including runtime libraries)</dd>
</dl>

<h3>Installation</h3>

<p>
(D)COM Server installs COM-servers and Active X controls. On most Windows
installations, this requires the user running setup to be a member of at least
the <EM>Power Users</EM> or <EM>Administrators</EM> group. Please contact your
system administrator if your user account is not a member of one of these
groups. (More specifically, the setup requires write access in the computer's
registry database under <code>HKEY_CLASSES_ROOT</code>.)
</p>

<ul>
<li>Install the latest Scilab release (&gt;= Scilab 4.1).
<li>If a previous version of (D)COM Server is currently installed, please
uninstall this version first
<ul>
<li>close all client applications using the COM server
<li>uninstall the previous version using "Add/Remove Programs"
</ul>
<li>Start the setup program
<li>Scilab (D)COM Server installation
</p>

<ul>
<li>Which Package shall I Install?
</p>
<p>
<code>R_Scilab_DCOM3.0-1B5.exe</code> is a full installer and provides all required
components including runtime libraries for Visual Basic and Visual
C++. Previous versions provided an installer without the runtime libraries,
too. This isn't supported any more.
</p>
<p>
If you don't want to make changes to the server software you won't have
to download and install the sources either. All information required for
creating a client application using the COM server is included in the
documentation and the sample code installed with the COM server.
<li>install <code>R_Scilab_DCOM3.0-1B5.exe</code>.
</p>
<p>
Installation allows you to choose between various default types of
installation.
</p>

<ul>
<li>If you want to develop client applications, you should choose a
"Development installation". This will install binaries for running
local and remote servers, test and sample applications, including
source code. An installation of Scilab is required on this machine, too.
</p>
<p>
When deploying your own client application to some machine, you have
to install Scilab (D)COM Server on this machine, too.
<li>If running Scilab locally on this machine, choose "Local Server
Installation". This will install binaries for the local COM servers
and a simple test application used for testing the basic
functionality of Scilab and the Scilab (D)COM Server installation. A local
installation of Scilab is required, too. This machine can be used for
running client applications using a local Scilab server and for providing
Scilab server objects for remote clients, too.
<li>For running a client application locally and accessing Scilab objects
installed on a remote server, choose "Remote Server Files" as your
setup option. This will set up necessary binaries for accessing an
installation of Scilab and Scilab (D)COM server on a remote machine. Scilab is not
required on this machine
</ul>
</ul>
<li>copy <code>sciproxy.dll</code> from the Scilab (D)COM servers setup folder
(sub-directory <code>Scilab</code>) to the <code>bin</code> directory of your Scilab 4.1
installation.
<li>start <code>01 - Basic Test</code> from the Scilab (D)COM Server program group in
the start menu and press "Start".
</ul>

<h3>Testing the (D)COM Server</h3>

<p>
Lots of example and test programs are provided with the Scilab (D)COM Server.
</p>
<p>
One of the test programs is always installed with the Scilab (D)COM Server. It can
be found in the Start Menu. The default program group is called <code>R\(D)COM
Server</code>, the test program found there is called <code>01 - Basic Test</code>.
</p>
<p>
Applications using the Scilab (D)COM Server always perform very similar steps:
</p>

<ul>
<li>create an instance of the <code>IStatConnector</code> interface
<li>call <code>Init</code> on the COM object to start up Scilab
<li>perform the application's work
<li>shut down the Scilab by calling <code>Close</code>
<li>release the COM object
</ul>

<p>
The test program just shows some diagnostic information and performs some
tests:
</p>

<ul>
<li>data transfer to Scilab
<li>perform some computations in Scilab
<li>data transfer from Scilab
</ul>

<h3>Troubleshooting</h3>

<p>
If anything goes wrong when calling <code>.Init()</code> of the COM object for the
first time, retrieve error information using <code>.GetErrorText()</code>:
</p>

<dl>
<dt>"installation problem: unable to load connector"</dt><dd>Scilab proxy library could not be loaded. The cause of this common failure
can be:
</p>

<ul>
<li>the environment variable <code>%SCILAB_HOME%</code> points to a directory
where Scilab is not installed <EM>and</EM>
<li>the registry key corresponding to your Scilab installation does not
point to the installation folder of Scilab <EM>and</EM>
<li><code>sciproxy.dll</code> and Scilab binaries cannot be found in the
<code>%PATH%</code>
</ul>

<p>
In case you have downloaded precompiled binaries from www.scilab.org
and installed them, something went wrong there. Please try to reinstall
Scilab using the setup program. Download "dbgview" (see section
"Resources") to find out what's going wrong.
</p>
<p>
If you have compiled Scilab yourself, check
<code>%SCILAB_HOME%\bin\sciproxy.dll</code> and the registry key
<code>HKEY_LOCAL_MACHINE\Software\Scilab\LASTINSTALL</code> does not point
to the registry key, telling Scilab is installed.
</p>
<p>
If the registry key is missing or wrong, re-install Scilab and do not
forget to check the box asking about putting information about Scilab into
the registry.</dd>
<dt>"installation problem: invalid connector library"</dt><dd>possibly damaged Scilab proxy library. This version of the COM server
requires Scilab &gt;= 4.1.</dd>
<dt>"installation problem: interpreter interface version mismatch"</dt><dd>wrong version of Scilab proxy library. This version of the COM server
requires Scilab &gt;= 4.1.</dd>
<dt>"installation problem: interpreter version mismatch"</dt><dd>wrong version of Scilab. This version of the COM server requires Scilab &gt;= 4.1.</dd>
</dl>

<p>
If a message box shows up on your call to .Init(), which tells you that the
base library could not be found, you probably should set <code>R_HOME</code> to
your installation folder. This should rarely be necessary.
</p>
<p>
If you cannot solve the installation problem by yourself, please try to
find help on the Scilab COM mailing list (see "Resources"). Subscribing to this
list is recommended if you want to use/are using the Scilab COM server (or any
other part of Scilab's COM connectivity modules).
</p>
<p>
All functions will return an error code corresponding to the texts
shown above. This error code is the return value of the functions when
called e.g. from C or C++ or can be retrieved by checking
<code>Err.Number</code> in VB or VBA. The following table will list the
error codes (defines for C/C++ and numbers)
</p>

<table summary="Rd table">
<tr>
  <td align="left"><B>Define</B>            </td>  <td align="center"> <B>Decimal</B> </td>  <td align="center"> <B>Hexadecimal</B> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDARG</code>         </td>  <td align="center"> <code>-2147221503</code> </td>  <td align="center"> <code>0x80040001</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDFORMAT</code>      </td>  <td align="center"> <code>-2147221502</code> </td>  <td align="center"> <code>0x80040002</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_NOTIMPL</code>            </td>  <td align="center"> <code>-2147221501</code> </td>  <td align="center"> <code>0x80040003</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_UNKNOWN</code>            </td>  <td align="center"> <code>-2147221500</code> </td>  <td align="center"> <code>0x80040004</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INITIALIZED</code>        </td>  <td align="center"> <code>-2147221499</code> </td>  <td align="center"> <code>0x80040005</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_NOTINITIALIZED</code>     </td>  <td align="center"> <code>-2147221498</code> </td>  <td align="center"> <code>0x80040006</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDSYMBOL</code>      </td>  <td align="center"> <code>-2147221497</code> </td>  <td align="center"> <code>0x80040007</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_PARSE_INVALID</code>      </td>  <td align="center"> <code>-2147221496</code> </td>  <td align="center"> <code>0x80040008</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_PARSE_INCOMPLETE</code>   </td>  <td align="center"> <code>-2147221495</code> </td>  <td align="center"> <code>0x80040009</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_UNSUPPORTEDTYPE</code>    </td>  <td align="center"> <code>-2147221494</code> </td>  <td align="center"> <code>0x8004000A</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_EVALUATE_STOP</code>      </td>  <td align="center"> <code>-2147221493</code> </td>  <td align="center"> <code>0x8004000B</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDINTERFACEVERSION</code>   </td>  <td align="center"> <code>-2147221488</code> </td>  <td align="center"> <code>0x80040010</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDINTERPRETERVERSION</code> </td>  <td align="center"> <code>-2147221487</code> </td>  <td align="center"> <code>0x80040011</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INTERFACENOTFOUND</code>        </td>  <td align="center"> <code>-2147221486</code> </td>  <td align="center"> <code>0x80040012</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_LIBRARYNOTFOUND</code>          </td>  <td align="center"> <code>-2147221485</code> </td>  <td align="center"> <code>0x80040013</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDLIBRARY</code>           </td>  <td align="center"> <code>-2147221484</code> </td>  <td align="center"> <code>0x80040014</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INITIALIZATIONFAILED</code>     </td>  <td align="center"> <code>-2147221483</code> </td>  <td align="center"> <code>0x80040015</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDCONNECTORNAME</code>     </td>  <td align="center"> <code>-2147221482</code> </td>  <td align="center"> <code>0x80040016</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDINTERPRETERSTATE</code>  </td>  <td align="center"> <code>-2147221481</code> </td>  <td align="center"> <code>0x80040017</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_FATALBACKEND</code>       </td>  <td align="center"> <code>-2147221472</code> </td>  <td align="center"> <code>0x80040020</code> </td>
</tr>
</table>


<h3>Registry Information</h3>

<p>
The setup program will add information to the registry. This information can be
found in
<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\R
(D)COM Server_is1</code>.
</p>
<p>
In addition to that, various COM servers are registered.
</p>


<h3>Re-Packaging and Silent installation</h3>

<p>
See <a href="../SC_PUBLIC">../SC_PUBLIC</a> for information on redistribution. In general,
redistribution of <font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM Server is very limited.
</p>
<p>
Please contact Thomas Baier (<a href="mailto:thomas.baier@gmx.net">thomas.baier@gmx.net</a>) for more information
on redistribution.
</p>


<h3>General Information and Current Limitations</h3>

<p>
Scilab support is currently under development. Manual installation of
<code>sciproxy.dll</code> is still required, but chances are good, that this will
not be required for future versions of Scilab.
</p>
<p>
To discuss (general) Scilab-related topics have a look at www.scilab.org. You
can find more information there. To discuss Scilab (D)COM Server related
topics, please subscribe to rcom-l the mailing list dedicated to <font face="Courier New,Courier" color="#666666"><b>R</b></font> COM
connectivity. This list&mdash;despite its name&mdash;will also contain discussions for
Scilab related topics.
</p>
<p>
Data type support for Scilab is more limited than data type support for
<font face="Courier New,Courier" color="#666666"><b>R</b></font>. Currently, scalar values (boolean, integer, floating point, strings) and
any-dimensional arrays of these scalar values are supported. Transfer of arrays
or matrices with mixed types is not supported at the moment.
</p>



<hr><div align="center">[Package <a href="00Index.html">Index]</a></div>

</body></html>
