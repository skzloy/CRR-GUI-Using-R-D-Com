<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Installation</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="RDCOM.css">
</head><body>


<h2>Installation</h2>


<h3></h3>

<p>
This file describes the installation procedure and provides help when running
the basic examples fails.
</p>
<p>
<font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM Server &gt;= 3.00 requires <font face="Courier New,Courier" color="#666666"><b>R</b></font> version 2.7.0 or later or Scilab
5.0 or later. Installing the <font face="Courier New,Courier" color="#666666"><b>R</b></font> package <code>rscproxy</code> is required for
connecting to <font face="Courier New,Courier" color="#666666"><b>R</b></font>, installation of <code>sciproxy.dll</code> is required for
connecting to Scilab.
</p>


<h3>Archives</h3>

<dl>
<dt><code>R_Scilab_DCOM3.0-1B5.exe</code></dt><dd>setup program for server and sample code (including runtime libraries)</dd>
</dl>

<h3>Installation</h3>

<p>
<font face="Courier New,Courier" color="#666666"><b>R</b></font> (D)COM Server installs COM-servers and Active X controls. On most Windows
installations, this requires the user running setup to be a member of at least
the <EM>Power Users</EM> or <EM>Administrators</EM> group. Please contact your
system administrator if your user account is not a member of one of these
groups. (More specifically, the setup requires write access in the computer's
registry database under <code>HKEY_CLASSES_ROOT</code>.)
</p>

<ul>
<li>Install the latest <font face="Courier New,Courier" color="#666666"><b>R</b></font> release (&gt;= <font face="Courier New,Courier" color="#666666"><b>R</b></font> 2.7.0).
<li>Install the <font face="Courier New,Courier" color="#666666"><b>R</b></font> package <code>rscproxy</code> from CRAN.
<li>If a previous version of <font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM Server is currently installed,
please uninstall this version first
<ul>
<li>close all client applications using the COM server
<li>uninstall the previous version using "Add/Remove Programs"
</ul>
<li>Start the setup program
<li><font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM Server installation
</p>

<ul>
<li>Which Package shall I Install?
</p>
<p>
<code>R_Scilab_DCOM3.0-1B5.exe</code> is a full installer and provides all required
components including runtime libraries for Visual Basic and Visual
C++. Previous versions provided an installer without the runtime libraries,
too. This isn't supported any more.
</p>
<p>
For using the <font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM Server to access <font face="Courier New,Courier" color="#666666"><b>R</b></font> or Scilab, you do not need
the source code for <font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM Server. All information required for
creating a client application using the COM server is included in the
documentation and the sample code installed with the COM server.
<li>install <code>R_Scilab_DCOM3.0-1B5.exe</code>.
</p>
<p>
Installation allows you to choose between various default types of
installation.
</p>

<ul>
<li>If you want to develop client applications, you should choose a
"Development installation". This will install binaries for running local and
remote servers, test and sample applications, including source code. An
installation of <font face="Courier New,Courier" color="#666666"><b>R</b></font> or Scilab is required on this machine, too.
</p>
<p>
When deploying your own client application to some machine, your user will
have to download and install <font face="Courier New,Courier" color="#666666"><b>R</b></font> (D)COM Server for this machine, too.
<li>If running <font face="Courier New,Courier" color="#666666"><b>R</b></font> locally on this machine, choose "Local Server
Installation". This will install binaries for the local COM servers and a
simple test application used for testing the basic functionality of <font face="Courier New,Courier" color="#666666"><b>R</b></font> and
the <font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM Server installation. A local installation of <font face="Courier New,Courier" color="#666666"><b>R</b></font> is
required, too. This machine can be used for running client applications using
a local <font face="Courier New,Courier" color="#666666"><b>R</b></font> server and for providing <font face="Courier New,Courier" color="#666666"><b>R</b></font> server objects for remote clients,
too.
<li>For running a client application locally and accessing <font face="Courier New,Courier" color="#666666"><b>R</b></font> objects
installed on a remote server, choose "Remote Server Files" as your setup
option. This will set up necessary binaries for accessing an installation of
<font face="Courier New,Courier" color="#666666"><b>R</b></font> and <font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM server on a remote machine. <font face="Courier New,Courier" color="#666666"><b>R</b></font> is not required on
this machine </ul> </ul>
<li>start <code>01 - Basic Test</code> from the <font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM Server program
group in the start menu and press "Start".  </ul>

<h3>Testing the (D)COM Server</h3>

<p>
Lots of example and test programs are provided with the <font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM
Server.
</p>
<p>
One of the test programs is always installed with the <font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM
Server. It can be found in the Start Menu. The default program group is called
<code>R\(D)COM Server</code>, the test program found there is called <code>01 - Basic
  Test</code>.
</p>
<p>
Applications using the <font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM Server always perform very similar
steps:
</p>

<ul>
<li>create an instance of the <code>IStatConnector</code> interface
<li>call <code>Init</code> on the COM object to start up <font face="Courier New,Courier" color="#666666"><b>R</b></font>
<li>perform the application's work
<li>shut down the <font face="Courier New,Courier" color="#666666"><b>R</b></font> by calling <code>Close</code>
<li>release the COM object
</ul>

<p>
The test program just shows some diagnostic information and performs some
tests:
</p>

<ul>
<li>data transfer to <font face="Courier New,Courier" color="#666666"><b>R</b></font> or Scilab
<li>perform some computations in <font face="Courier New,Courier" color="#666666"><b>R</b></font> or Scilab
<li>data transfer from <font face="Courier New,Courier" color="#666666"><b>R</b></font> or Scilab
</ul>

<h3>Troubleshooting</h3>

<p>
If anything goes wrong when calling <code>.Init()</code> of the COM object for the
first time, retrieve error information using <code>.GetErrorText()</code>:
</p>

<dl>
<dt>"installation problem: unable to load connector"</dt><dd><font face="Courier New,Courier" color="#666666"><b>R</b></font> proxy library could not be loaded. The cause of this common failure
can be:
</p>

<ul>
<li>the environment variable <code>%R_HOME%</code> points to a directory
where <font face="Courier New,Courier" color="#666666"><b>R</b></font> is not installed <EM>and</EM>
<li>the registry key corresponding to your <font face="Courier New,Courier" color="#666666"><b>R</b></font> installation does not
point to the installation folder of <font face="Courier New,Courier" color="#666666"><b>R</b></font> <EM>and</EM>
<li><code>rproxy.dll</code> and <code>R.dll</code> cannot be found in the
<code>%PATH%</code>
</ul>

<p>
In case you have downloaded precompiled binaries from CRAN and installed
them, something went wrong there. Please try to reinstall <font face="Courier New,Courier" color="#666666"><b>R</b></font> using the
setup program. Download "dbgview" (see section "Resources") to find out
what's going wrong.
</p>
<p>
If you have compiled <font face="Courier New,Courier" color="#666666"><b>R</b></font> yourself, check
<code>%R_HOME%\bin\rproxy.dll</code> and the registry key
<code>HKEY_LOCAL_MACHINE\Software\R-core\R\InstallPath</code> if this one
points to your <font face="Courier New,Courier" color="#666666"><b>R</b></font> installation folder. Starting with <font face="Courier New,Courier" color="#666666"><b>R</b></font> 2.2.0, the
registry key <code>HKEY_CURRENT_USER\Software\R-core\R\InstallPath</code>
can also be used. The <font face="Courier New,Courier" color="#666666"><b>R</b></font> (D)COM Server first looks at the key under
<code>HKEY_CURRENT_USER</code>.
</p>
<p>
If the registry key is missing or wrong, re-install <font face="Courier New,Courier" color="#666666"><b>R</b></font> and do not
forget to check the box asking about putting information about <font face="Courier New,Courier" color="#666666"><b>R</b></font> into
the registry. Alternatively, you can call <code>RSetReg.exe</code> from a
command window.</dd>
<dt>"installation problem: invalid connector library"</dt><dd>possibly damaged <font face="Courier New,Courier" color="#666666"><b>R</b></font> proxy library. This version of the COM server
requires <font face="Courier New,Courier" color="#666666"><b>R</b></font> &gt;= 2.2.</dd>
<dt>"installation problem: interpreter interface version mismatch"</dt><dd>wrong version of <font face="Courier New,Courier" color="#666666"><b>R</b></font> proxy library. This version of the COM server
requires <font face="Courier New,Courier" color="#666666"><b>R</b></font> &gt;= 2.2.</dd>
<dt>"installation problem: interpreter version mismatch"</dt><dd>wrong version of <font face="Courier New,Courier" color="#666666"><b>R</b></font>. This version of the COM server requires <font face="Courier New,Courier" color="#666666"><b>R</b></font> &gt;= 2.2.</dd>
</dl>

<p>
If a message box shows up on your call to .Init(), which tells you that the
base library could not be found, you probably should set <code>R_HOME</code> to
your installation folder. This should rarely be necessary.
</p>
<p>
If you cannot solve the installation problem by yourself, please try to
find help on the <font face="Courier New,Courier" color="#666666"><b>R</b></font> COM mailing list (see "Resources"). Subscribing to this
list is recommended if you want to use/are using the <font face="Courier New,Courier" color="#666666"><b>R</b></font> COM server (or any
other part of <font face="Courier New,Courier" color="#666666"><b>R</b></font>'s COM connectivity modules).
</p>
<p>
All functions will return an error code corresponding to the texts
shown above. This error code is the return value of the functions when
called e.g. from C or C++ or can be retrieved by checking
<code>Err.Number</code> in VB or VBA. The following table will list the
error codes (defines for C/C++ and numbers)
</p>

<table summary="Rd table">
<tr>
  <td align="left"><B>Define</B>            </td>  <td align="center"> <B>Decimal</B> </td>  <td align="center"> <B>Hexadecimal</B> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDARG</code>         </td>  <td align="center"> <code>-2147221503</code> </td>  <td align="center"> <code>0x80040001</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDFORMAT</code>      </td>  <td align="center"> <code>-2147221502</code> </td>  <td align="center"> <code>0x80040002</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_NOTIMPL</code>            </td>  <td align="center"> <code>-2147221501</code> </td>  <td align="center"> <code>0x80040003</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_UNKNOWN</code>            </td>  <td align="center"> <code>-2147221500</code> </td>  <td align="center"> <code>0x80040004</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INITIALIZED</code>        </td>  <td align="center"> <code>-2147221499</code> </td>  <td align="center"> <code>0x80040005</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_NOTINITIALIZED</code>     </td>  <td align="center"> <code>-2147221498</code> </td>  <td align="center"> <code>0x80040006</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDSYMBOL</code>      </td>  <td align="center"> <code>-2147221497</code> </td>  <td align="center"> <code>0x80040007</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_PARSE_INVALID</code>      </td>  <td align="center"> <code>-2147221496</code> </td>  <td align="center"> <code>0x80040008</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_PARSE_INCOMPLETE</code>   </td>  <td align="center"> <code>-2147221495</code> </td>  <td align="center"> <code>0x80040009</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_UNSUPPORTEDTYPE</code>    </td>  <td align="center"> <code>-2147221494</code> </td>  <td align="center"> <code>0x8004000A</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_EVALUATE_STOP</code>      </td>  <td align="center"> <code>-2147221493</code> </td>  <td align="center"> <code>0x8004000B</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDINTERFACEVERSION</code>   </td>  <td align="center"> <code>-2147221488</code> </td>  <td align="center"> <code>0x80040010</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDINTERPRETERVERSION</code> </td>  <td align="center"> <code>-2147221487</code> </td>  <td align="center"> <code>0x80040011</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INTERFACENOTFOUND</code>        </td>  <td align="center"> <code>-2147221486</code> </td>  <td align="center"> <code>0x80040012</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_LIBRARYNOTFOUND</code>          </td>  <td align="center"> <code>-2147221485</code> </td>  <td align="center"> <code>0x80040013</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDLIBRARY</code>           </td>  <td align="center"> <code>-2147221484</code> </td>  <td align="center"> <code>0x80040014</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INITIALIZATIONFAILED</code>     </td>  <td align="center"> <code>-2147221483</code> </td>  <td align="center"> <code>0x80040015</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDCONNECTORNAME</code>     </td>  <td align="center"> <code>-2147221482</code> </td>  <td align="center"> <code>0x80040016</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_INVALIDINTERPRETERSTATE</code>  </td>  <td align="center"> <code>-2147221481</code> </td>  <td align="center"> <code>0x80040017</code> </td>
</tr>
<tr>
  <td align="left"> <code>SCN_E_FATALBACKEND</code>       </td>  <td align="center"> <code>-2147221472</code> </td>  <td align="center"> <code>0x80040020</code> </td>
</tr>
</table>


<h3>Registry Information</h3>

<p>
The setup program will add information to the registry. This information can be
found in
<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\R
(D)COM Server_is1</code>.
</p>
<p>
In addition to that, various COM servers are registered.
</p>


<h3>Re-Packaging and Silent installation</h3>

<p>
See <a href="../SC_PUBLIC">../SC_PUBLIC</a> for information on redistribution. In general,
redistribution of <font face="Courier New,Courier" color="#666666"><b>R</b></font>/Scilab (D)COM Server is very limited.
</p>
<p>
Please contact Thomas Baier (<a href="mailto:thomas.baier@gmx.net">thomas.baier@gmx.net</a>) for more information
on redistribution.
</p>



<hr><div align="center">[Package <a href="00Index.html">Index]</a></div>

</body></html>
