<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: RServerManager</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="RDCOM.css">
</head><body>


<h2>RServerManager</h2>


<h3>RServerManager: A Short Introduction</h3>

<p>
<font face="Courier New,Courier" color="#666666"><b>R</b></font> (D)COM server provides a mechanism for standard applications like
Microsoft Excel or custom applications written in any language serving
as a COM client (e.g. Visual Basic, Perl) to use the <font face="Courier New,Courier" color="#666666"><b>R</b></font> as a powerful
computational engine and renderer for graphics and text output.
</p>
<p>
The current implementation of the <font face="Courier New,Courier" color="#666666"><b>R</b></font> server package puts every single
<font face="Courier New,Courier" color="#666666"><b>R</b></font> interpreter used in a client application into a separate address
space, allowing different code and data segments for multiple
instances of the interpreter even in a single client instance.
</p>
<p>
On the other hand, using COM/DCOM to expose <font face="Courier New,Courier" color="#666666"><b>R</b></font>'s functionality to
client applications even makes it possible to share a single instance
of an R interpreter between multiple client applications, both running
on the same or even on different machines in the network. Sharing an
interpreter instance also implies a shared data and code segment for
<font face="Courier New,Courier" color="#666666"><b>R</b></font>.
</p>
<p>
The implementation using COM takes care of synchronizing access to the
interpreter, so only one client can use the server's functionality at
the same time.
</p>
<p>
Using these COM/DCOM features to share a single interpreter requires
some level of "intelligence" in the client applications and
cooperation between these. One client has to create the interpreter
instance and all clients have to gain access to this object in some
way, by using some kind of data exchange.
</p>
<p>
This is the situation where a generic concept for managing and sharing
interpreters is required: the <font face="Courier New,Courier" color="#666666"><b>R</b></font> Server Manager.
</p>


<h3>RServerManager: Using the Server Manager</h3>

<p>
The core of the server manager is the COM object
<code>RServerManager.ServerPool</code>. Every client application has to use an
instance of this CoClass to gain access to some shared
interpreter. The object itself provides a collection-like interface to
a shared collection of COM objects each of them representing an <font face="Courier New,Courier" color="#666666"><b>R</b></font>
interpreter.
</p>
<p>
To share server objects between client applications on different
machines, the <code>RServerManager.ServerPool</code> objects must run on a single
machine in the network managing all server instances. While all server
objects are managed on a centralized server machine, this does not
necessarily mean, that the <font face="Courier New,Courier" color="#666666"><b>R</b></font> interpreters themselves have to be
instantiated on the same machine, too. The server manager only
provides a mechanism for managing shared <font face="Courier New,Courier" color="#666666"><b>R</b></font> servers and gaining access
to these.
</p>
<p>
As long as <code>RServerManager</code> lives, it can manage <font face="Courier New,Courier" color="#666666"><b>R</b></font>
servers. Either provide your own startup script or use the sample
"InitServers" for this purpose. As soon as the last program which uses
<code>RServerManager</code> terminates the server manager will close, too
and all <font face="Courier New,Courier" color="#666666"><b>R</b></font> instances in the repository will be released. In case any
application still has a reference to one of the <font face="Courier New,Courier" color="#666666"><b>R</b></font> processes, this
process will stay alive.
</p>
<p>
The sample application <code>InitServers</code> will provide means to add a
new <font face="Courier New,Courier" color="#666666"><b>R</b></font> server to the server manager interactively. Deleting is not
possible. The list will show the currently known <font face="Courier New,Courier" color="#666666"><b>R</b></font> servers and (in
braces) the number of servers available with the shown key.
</p>


<h3>RServerManager: Shared Use Scenario</h3>

<p>
Just get elements from the server manager (take care, you will get "Item"
elements) and use them for "shared" use.
</p>
<p>
Shared use means that everyone can access the same elements.
</p>
<p>
E.g. app1 can get a server with key "R" and app2 can get access to the same
server. This results in shared data space!
</p>
<p>
See <code>SharedUse</code> sample for more info
</p>


<h3>RServerManager: Exclusive Use</h3>

<p>
One can get a <font face="Courier New,Courier" color="#666666"><b>R</b></font> server from the server manager and request exclusive
use for this server (this is an atomic operation!). Other apps also
requesting exclusive use will not get access to the server.
</p>
<p>
Please take care to release the lock afterwards. It will not be released
automatically for you when your app terminates.
</p>
<p>
See <code>ExclusiveUse</code> sample.
</p>
<p>
Shared use can interfer with exclusive use. E.g. apps requesting
shared use won't honor a lock set by an exclusive use app. Never use a
mixed model for access to the same COM server.
</p>


<h3>RServerManager: Server Groups</h3>

<p>
You can add multiple servers with the same name. This will create
groups in the server manager. Exclusively requesting a server with a
specific name will just return <EM>one</EM> server (the first one) from
a group sharing the same name.
</p>
<p>
This is a good mechanism for server-pooling.
</p>


<h3>RServerManagerAdmin</h3>

<p>
RServerManagerAdmin is a new program which starts a given set of R
processes and makes this pool of server available to other programs.
</p>
<p>
If RServerManagerAdmin is started without any command line argument,
it will search for a file StartServers.cfg in the directory where it
is located and for each line in this file it will start an R
process. The process names may equal, then, more than one process with
the same process name will be started.  Creating shorcuts to the exe
file and modifying the command line in this shortcut will allow to
have startup commands for different configurations of servers. Windows
shortcuts can be configured in a way that the program is started
minimized. In this case, RServerManagerAdmin will only appear as an
icon in the system tray.
</p>



<hr><div align="center">[Package <a href="00Index.html">Index]</a></div>

</body></html>
